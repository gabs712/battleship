(()=>{"use strict";(()=>{const t=[],e=(e,o,r)=>{const n=function(){const t=document.createElement("div");return t.className="\n       outline-slate-500 outline-2 outline bg-gray-100\n    ",t.setAttribute("row",r),t.setAttribute("column",o),t}(),s=t=>{const e=["cursor-pointer","hover:bg-gray-200","active:bg-gray-300"];t?n.classList.add(...e):n.classList.remove(...e)};return{column:o,row:r,get:()=>n,addInteractivity:o=>{s(!0),function(o){n.addEventListener("click",(()=>{o(),s(!1),e.gameboard.isAllSunk()||(e=>{const o=e.gameboard.slots,r=document.querySelector("[data-grid2]");function n(t,e,r){return!(e<0||e>9||r<0||r>9)&&o[e][r]===t}const s=(e,r)=>{if(((e,o)=>{for(const r of t)if(r[0]===e&&r[1]===o)return!0;return!1})(e,r))return!1;const s=(()=>{for(const e of[...t].reverse())if("ship"===o[e[0]][e[1]].type)return e;return null})();if(null!==s){const t=o[s[0]][s[1]];if(!t.isSunk()&&!((t,e,o)=>!(e<0||e>9||o<0||o>9||!n(t,e,o)&&!n(t,e-1,o)&&!n(t,e+1,o)&&!n(t,e,o-1)&&!n(t,e,o+1)))(t,e,r))return!1}return!0};return{attack:()=>{let e,o;do{e=Math.floor(10*Math.random()),o=Math.floor(10*Math.random())}while(!s(e,o));t.push([e,o]),r.querySelector(`[row="${e}"][column="${o}"]`).obj.receiveAttack()}}})(e.enemy).attack()}),{once:!0})}(o)}}},o=(t,o)=>{const r=(t,r)=>{const n=o.gameboard.slots[t][r];if("ship"===n.type){const n=((t,o,r)=>{const n=e(t,o,r),s=n.get();t.isComputer&&n.addInteractivity(a);const c=()=>{document.body.innerHTML="";const e=document.createElement("div");document.body.append(e),e.classList.add("text-lg"),t.isComputer?(e.innerText="You win",e.classList.add("text-green-400")):(e.innerText="You lose",e.classList.add("text-red-400"))};function a(){t.gameboard.receiveAttack(r,o),s.classList.remove("bg-gray-100"),s.classList.remove("bg-violet-200"),s.classList.add("bg-red-300"),t.gameboard.slots[r][o].isSunk()&&i(t.isComputer?1:2),t.gameboard.isAllSunk()&&setTimeout(c,800)}const i=e=>{const n=t.gameboard.slots,s=t.gameboard.slots[r][o];for(const[t,o]of n.entries())for(const[r,n]of o.entries())if(n===s){const o=document.querySelector(`[data-grid${e}] [row="${t}"][column="${r}"]`);o.classList.replace("outline-slate-500","outline-red-500"),o.classList.add("z-10")}};return{...n,receiveAttack:a}})(o,r,t);return o.isComputer||n.get().classList.add("bg-violet-200"),n}if("empty"===n.type)return((t,o,r)=>{const n=e(t,o,r),s=n.get();function c(){t.gameboard.receiveAttack(r,o),s.classList.replace("bg-gray-100","bg-blue-200")}return t.isComputer&&n.addInteractivity(c),{...n,receiveAttack:c}})(o,r,t)};return{setup:()=>{t.innerHTML="";const r=o.gameboard.slots;for(const[n,s]of r.entries())for(const[r]of s.entries()){const s=e(o,r,n).get();t.append(s)}},start:()=>{t.innerHTML="";const e=o.gameboard.slots;for(const[o,n]of e.entries())for(const[e]of n.entries()){const n=r(o,e);n.get().obj=n,t.append(n.get())}}}},r=()=>{const t=function(){const t=[];for(let e=0;e<10;e++){t[e]=[];for(let o=0;o<10;o++)t[e][o]={type:"empty"}}return t}();return{placeShipAt:(e,o,r)=>{t[o][r]=e},receiveAttack:(e,o)=>{const r=t[e][o];"ship"===r.type?r.hit():"empty"===r.type&&(t[e][o].type="missed")},isAllSunk:()=>{let e=!1;for(const o of t)for(const t of o)if("ship"===t.type&&(e=!0,!t.isSunk()))return!1;return!!e},slots:t}},n=(t,e)=>({isComputer:t,enemy:e,gameboard:r()}),s=t=>{let e=0;return{type:"ship",hit:()=>{e++},isSunk:()=>e>=t,size:t}},c=t=>{let e,{size:o}=t;return{get:()=>{do{e=Math.floor(10*Math.random())}while(e+(o-1)>9);return e}}},a=(t,e)=>{const o=[],r=(t,e)=>{let[o,r]=t,[n,s]=e;return o===n&&r===s},n=(t,e)=>{let[o,r]=t,[n,s]=e;return o-1===n&&r===s||o+1===n&&r===s||o===n&&r-1===s||o===n&&r+1===s},s=()=>{const i=((e,o)=>{const r=[],n=a();for(let s=0;s<t.size;s++)"row"===n?r.push([e,o+s]):"column"===n&&r.push([o+s,e]);return r})(c(t).get(),c(t).get());(t=>{for(const o of e)for(const e of o.coordinate)for(const o of t){if(r(o,e))return!0;if(n(o,e))return!0}return!1})(i)?s():o.push(...i)},a=()=>{const t=Math.floor(2*Math.random());return 0===t?"row":1===t?"column":void 0};return{get:()=>(s(),o)}},i=(t,e)=>{const o=[],r=[s(5),s(4),s(3),s(3),s(2)],n=u(o,e),c=()=>{for(const t of r){const e={ship:t,coordinate:a(t,o).get()};o.push(e)}};return{preview:()=>{n.clear(),o.splice(0,o.length),c(),n.paint()},place:()=>{for(const e of o)for(const o of e.coordinate)t.gameboard.placeShipAt(e.ship,o[0],o[1])},generateData:c}},u=(t,e)=>({paint:()=>{for(const o of t)for(const t of o.coordinate)e.querySelector(`[row="${t[0]}"][column="${t[1]}"]`).classList.replace("bg-gray-100","bg-violet-200")},clear:()=>{const t=e.children;for(const e of t)e.classList.replace("bg-violet-200","bg-gray-100")}}),l=document.querySelector("[data-grid1]"),d=document.querySelector("[data-grid2]"),f=n(!0),m=n(!1);f.enemy=m,m.enemy=f;const p=o(l,f),g=o(d,m);p.setup(),g.setup();const y=i(f,l),b=i(m,d);b.preview();const v=document.querySelector("[data-randomize-buttom]");v.addEventListener("click",(()=>{b.preview()}));const h=document.querySelector("[data-start-button]");h.addEventListener("click",(()=>{b.place(),y.generateData(),y.place(),p.start(),g.start(),v.remove(),h.remove()}))})()})();
//# sourceMappingURL=main.bundle.js.map